lotSize:rooms + heating:sewer + fireplaces:sewer + lotSize:sewer +
bedrooms:sewer + bathrooms:sewer + landValue:fuel + fuel:sewer +
age:waterfront, data = saratoga_training)
lm6 = lm(price ~ . - sewer - fuel - heating - fireplaces - pctCollege, data = saratoga_training)
lm7 = lm(price ~ . + I(livingArea^2)- sewer - fuel - heating - fireplaces - pctCollege, data = saratoga_training)
#Run it on the actual and the predicted values
RMSE1[i]= rmse(lm1, saratoga_testing)
RMSE2[i]= rmse(lm2, saratoga_testing)
RMSE3[i]= rmse(lm3, saratoga_testing)
RMSE4[i]= rmse(lm4, saratoga_testing)
RMSE5[i]= rmse(lm5, saratoga_testing)
RMSE6[i]= rmse(lm6, saratoga_testing)
RMSE7[i]= rmse(lm7, saratoga_testing)
}
mean(RMSE1)
mean(RMSE5)
mean(RMSE6)
mean(RMSE7)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(foreach)
library(FNN)
library(caret)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
RMSE1 <- NULL
RMSE2 <- NULL
RMSE3 <- NULL
RMSE4 <- NULL
RMSE5 <- NULL
RMSE6 <- NULL
RMSE7 <- NULL
RMSE8 <- NULL
for (i in seq(1:500)){
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
lm1 = lm(price ~ lotSize + bedrooms + bathrooms, data=saratoga_training)
lm2 = lm(price ~ . - pctCollege - sewer - waterfront - landValue - newConstruction, data=saratoga_training)
lm3 = lm(price ~ (. - pctCollege - sewer - waterfront - landValue - newConstruction)^2, data=saratoga_training)
lm4 = lm(price ~ . , data = saratoga_training)
lm5 = lm(price ~ lotSize + age + landValue + livingArea +
pctCollege + bedrooms + fireplaces + bathrooms + rooms +
heating + fuel + sewer + waterfront + newConstruction + centralAir +
livingArea:centralAir + landValue:newConstruction + bathrooms:heating +
livingArea:fuel + age:sewer + age:pctCollege + landValue:fireplaces +
livingArea:fireplaces + fireplaces:waterfront + livingArea:waterfront +
age:centralAir + fuel:centralAir + bedrooms:fireplaces +
lotSize:landValue + bedrooms:waterfront + landValue:bathrooms +
pctCollege:newConstruction + heating:waterfront + rooms:heating +
bedrooms:fuel + pctCollege:fireplaces + livingArea:pctCollege +
lotSize:rooms + heating:sewer + fireplaces:sewer + lotSize:sewer +
bedrooms:sewer + bathrooms:sewer + landValue:fuel + fuel:sewer +
age:waterfront, data = saratoga_training)
lm6 = lm(price ~ . - sewer - fuel - heating - fireplaces - pctCollege, data = saratoga_training)
#Run it on the actual and the predicted values
RMSE1[i]= rmse(lm1, saratoga_testing)
RMSE2[i]= rmse(lm2, saratoga_testing)
RMSE3[i]= rmse(lm3, saratoga_testing)
RMSE4[i]= rmse(lm4, saratoga_testing)
RMSE5[i]= rmse(lm5, saratoga_testing)
RMSE6[i]= rmse(lm6, saratoga_testing)
}
stargazer::stargazer(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5,RMSE6)
standardize = function(x){
return ((x-mean(x,na.rm = TRUE))/sd(x, na.rm = TRUE))
}
std_data= as.data.frame(apply(SaratogaHouses, 2,standardize))
data(SaratogaHouses)
data(SaratogaHouses)
View(SaratogaHouses)
View(SaratogaHouses)
standardize = function(x){
return ((x-mean(x,na.rm = TRUE))/sd(x, na.rm = TRUE))
}
std_data= as.data.frame(apply(SaratogaHouses[2:10], 2,standardize))
Total = nrow(std_data)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
Total = nrow(std_data)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = std_data[saratoga_training,]
saratoga_testing = std_data[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
XTest = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_testing)
View(std_data)
View(std_data)
help apply
testing <- scale(SaratogaHouses)
h1 <- data.frame(SaratogaHouses)
testing <- scale(h1)
SaratogaHouses %>% mutate(lotSize = (lotSize - mean(lotSize,na.rm = TRUE))/sd(lotSize, na.rm = TRUE))
View(SaratogaHouses)
SaratogaHouses %>% mutate(lotSize = (lotSize - mean(lotSize,na.rm = TRUE))/sd(lotSize, na.rm = TRUE),landValue = (landValue - mean(landValue,na.rm = TRUE))/sd(landValue, na.rm = TRUE))
View(SaratogaHouses)
head(SaratogaHouses)
SaratogaHouses[] <- lapply(SaratogaHouses, function(x) if(is.numeric(x)){
scale(x, center=TRUE, scale=TRUE)
} else x)
View(SaratogaHouses)
View(SaratogaHouses)
SaratogaHouses[] <- lapply(SaratogaHouses, function(x) if(is.numeric(x)){
scale(x, center=TRUE, scale=TRUE)
} else x)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = std_data[saratoga_training,]
saratoga_testing = std_data[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
data(SaratogaHouses)
data(SaratogaHouses)
SaratogaHouses%>%mutate_if(is.numeric,scale)
View(SaratogaHouses)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(tidyverse)
library(ggplot2)
library(modelr)
library(rsample)
library(mosaic)
library(foreach)
library(FNN)
library(caret)
Testing <- scale(SaratogaHouses)
data(SaratogaHouses)
SaratogaHouses$landValue <- scale(SaratogaHouses$landValue)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = std_data[saratoga_training,]
saratoga_testing = std_data[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
knn_model = knnreg(saratoga_training$price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = std_data[saratoga_training,]
saratoga_testing = std_data[saratoga_testing,]
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ XTrain,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
View(saratoga_training)
View(saratoga_training)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = std_data[saratoga_training,]
saratoga_testing = std_data[saratoga_testing,]
View(saratoga_training)
View(saratoga_training)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
View(lm6)
View(saratoga_training)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
View(saratoga_training)
data(SaratogaHouses)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
lm_all = lm(price ~ ., data=SaratogaHouses)
lm_step = step(lm_all,
scope=~(.)^2)
Total = nrow(SaratogaHouses)
saratoga_train = round(Total*0.80)
saratoga_train = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~  . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~  . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
data(SaratogaHouses)
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_train, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
saratoga_training = sample.int(Total, saratoga_training, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
XTest = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_testing)
Ytraining = saratoga_training$price
Ytesting = saratoga_testing$price
scale_training = apply(Xtrain, 2, sd)
Xscaled_train = scale(Xtrain, scale = scale_training)
Xscaled_test = scale(Xtest, scale = scale_training)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ Xtrain,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ XTrain,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_train)
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_training)
saratoga_training = sample.int(Total, saratoga_training, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
XTest = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_testing)
Ytraining = saratoga_training$price
Ytesting = saratoga_testing$price
scale_training = apply(Xtrain, 2, sd)
Total = nrow(SaratogaHouses)
saratoga_training = round(Total*0.80)
saratoga_testing = (Total-saratoga_training)
saratoga_training = sample.int(Total, saratoga_training, replace=FALSE)
saratoga_testing = setdiff(1:Total,  saratoga_training)
saratoga_training = SaratogaHouses[saratoga_training,]
saratoga_testing = SaratogaHouses[saratoga_testing,]
XTrain = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_training)
XTest = model.matrix(~ lotSize + pctCollege  + heating  + bathrooms + bedrooms
+ rooms + fuel + centralAir + landValue, data=saratoga_testing)
Ytraining = saratoga_training$price
Ytesting = saratoga_testing$price
scale_training = apply(XTrain, 2, sd)
Xscaled_train = scale(XTrain, scale = scale_training)
Xscaled_test = scale(XTest, scale = scale_training)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ XTrain,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ Xscaled_train,saratoga_training, k=K)
rmse(knn_model,Xscaled_test)
}
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ Xscaled_train,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
XTrain = model.matrix(~ . - sewer - fuel - heating - fireplaces - pctCollege, data=saratoga_training)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ XTrain,saratoga_training, k=K)
rmse(knn_model,saratoga_testing)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
scale_training = apply(XTrain, 2, sd)
Xscaled_train = scale(XTrain, scale = scale_training)
Xscaled_test = scale(XTest, scale = scale_training)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ Xscaled_train,scale_training, k=K)
rmse(knn_model,saratoga_testing)
}
data(SaratogaHouses)
# Split into training and testing sets
saratoga_split = initial_split(SaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotsize','landValue', "livingArea"), ~(scale(.) %>% as.vector))
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize','landValue', "livingArea"), ~(scale(.) %>% as.vector))
StanSaratogaHouses
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"Age",'landValue', "livingArea",), ~(scale(.) %>% as.vector))
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"Age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c("price",'lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression: 65 AMGs")
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ind_best = which.min(rmse_grid_out$RMSE)
ind_best = which.min(rmse_grid$RMSE)
k_best = k_grid[ind_best]
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression", subtitle = k_best)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression")
ggplot(rmse_grid)+
geom_point(aes(x=K, y= RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression")
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression")
ind_best = which.min(rmse_grid$RMSE)
k_best = k_grid[ind_best]
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression")
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression", subtitle = k_best)
min(rmse_grid$RMSE)
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
k_min(rmse_grid$RMSE)
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
k_min=min(rmse_grid$RMSE)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression", subtitle = k_min)
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
rmse_grid = data.frame(K = k_grid, RMSE = rmse_grid)
min(rmse_grid$RMSE)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression", subtitle = k_best)
Value=min(rmse_grid$RMSE)
ggplot(rmse_grid)+
geom_point(aes(x=K, y=RMSE))+
labs(y="RMSE", title="RMSE vs k for KNN regression", subtitle = Value)
for (i in seq(1:500)){
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
}
View(SaratogaHouses)
View(SaratogaHouses)
StanSaratogaHouses <- SaratogaHouses %>%
mutate_at(c('lotSize',"age",'landValue', "livingArea"), ~(scale(.) %>% as.vector))
saratoga_split = initial_split(StanSaratogaHouses, prop = 0.8)
saratoga_train = training(saratoga_split)
saratoga_test = testing(saratoga_split)
for (i in seq(1:100)){
k_grid = seq(2,100)
rmse_grid = foreach(K = k_grid, .combine='c') %do% {
knn_model = knnreg(price ~ . - sewer - fuel - heating - fireplaces - pctCollege,saratoga_train, k=K)
rmse(knn_model,saratoga_test)
}
}
